## 37_lpi.dpatch by Daniel Holbach <daniel.holbach@ubuntu.com>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: No description.

diff -urNad xchat-2.6.1~/configure.in xchat-2.6.1/configure.in
--- xchat-2.6.1~/configure.in	2006-01-06 16:26:11.000000000 +0100
+++ xchat-2.6.1/configure.in	2006-01-15 20:06:55.000000000 +0100
@@ -160,7 +160,7 @@
 
 if test "$gtkfe" != yes; then
 	gnome=no
-	COMMON_LIBS="$GLIB_LIBS"
+	COMMON_LIBS="$GLIB_LIBS -llaunchpad-integration"
 	COMMON_CFLAGS="$GLIB_CFLAGS"
 fi
 
diff -urNad xchat-2.6.1~/src/fe-gtk/menu.c xchat-2.6.1/src/fe-gtk/menu.c
--- xchat-2.6.1~/src/fe-gtk/menu.c	2006-01-02 12:38:23.000000000 +0100
+++ xchat-2.6.1/src/fe-gtk/menu.c	2006-01-15 20:05:51.000000000 +0100
@@ -44,6 +44,8 @@
 #include <gtk/gtkversion.h>
 #include <gdk/gdkkeysyms.h>
 
+#include <launchpad-integration/launchpad-integration.h>
+
 #include "../common/xchat.h"
 #include "../common/xchatc.h"
 #include "../common/cfgfiles.h"
@@ -1934,7 +1936,11 @@
 			if (submenu)
 				gtk_menu_shell_append (GTK_MENU_SHELL (submenu), item);
 			else
+			{
 				gtk_menu_shell_append (GTK_MENU_SHELL (menu), item);
+				if (GTK_IS_MENU_BAR(menu_bar) && !strcmp(mymenu[i].text, "_About"))
+					launchpad_integration_add_items (menu, -1, TRUE, TRUE);
+			}
 			gtk_widget_show (item);
 			break;
 
